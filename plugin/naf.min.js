var version="1.0.8s4c2r99";NAF={};WebApp={};KeyMap.defineKeys(KeyMap.NORMAL,{3:"back"},!0);include("naf-webapp/"+version+"/naf-webapp.min.js");var model=new WebApp.Model,controller=new WebApp.Controller(model);controller.registerPMRPC();
controller.on("model.initialized",function(){var c=controller["do"],b=controller.getApplicationIndex;window.addEventListener("focus",function(){var a=b?b():1;c("model.state.applications."+a+"?state=running");active&&apps[active]&&send(active,"onSelect",{id:apps[active].currentViewId})});window.addEventListener("blur",function(){var a=b?b():1;c("model.state.applications."+a+".appMsg",{method:"paused",message:{}});active&&active!==ui&&send(active,"exit")});controller.on("model.state.key",function(){var a=
model.state.key,b=parseInt(a.keyCode,10),a=a.keyState.toLowerCase(),d=document.createEvent("Events"),c=document.activeElement||window;"repeat"===a&&(a="down");d.initEvent("key"+a,!0,!0);d.keyCode=d.which=b;d.key=KeyMap.lookupKey(KeyMap.NORMAL,b);c.dispatchEvent(d)});var f=b?b():1;controller.on("model.state.applications."+f+".appMsg",function(){var a=b?b():1,a=model.state.applications[a].appMsg,e;if(a.sourceId===model.state.applications[0].id){switch(a.method){case "getApplications":e=[]}e&&c("model.state.applications.0.appMsg",
{method:a.method,message:e})}});c("model.state.applications."+f+"?state=loaded")});controller.init();